<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>WeedTracker V60 Pilot</title>
  <link rel="stylesheet" href="styles.css" />

  <!-- Leaflet (mapping) -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
    defer
  ></script>

  <!-- Core scripts -->
  <script src="storage.js" defer></script>
  <script src="batches.js" defer></script>
  <script src="settings.js" defer></script>
  <script src="extras.js" defer></script>
  <script src="apps.js" defer></script>
</head>

<body>
  <!-- 🌿 Splash Screen -->
  <div id="splash" class="splash">
    <div class="logo">🌿</div>
    <div class="title">WeedTracker V60 Pilot</div>
    <div class="loading">Loading…</div>
  </div>

  <!-- Home -->
  <div id="home" class="screen active">
    <h1 class="home-title">WeedTracker V60 Pilot</h1>
    <div class="home-grid">
      <button id="createTaskBtn" class="home-card btn-task">🧾 Create Task</button>
      <button id="recordsBtn" class="home-card btn-records">📚 Records</button>
      <button id="inventoryBtn" class="home-card btn-chems">🧪 Chemical Inventory</button>
      <button id="batchesBtn" class="home-card btn-batches">⚗️ Batches</button>
      <button id="procurementBtn" class="home-card btn-proc">🛒 Procurement List</button>
      <button id="mappingBtn" class="home-card btn-map">🗺️ Mapping</button>
      <button id="settingsBtn" class="home-card btn-settings">⚙️ Settings</button>
    </div>
  </div>

  <!-- Create Task -->
  <div id="createTask" class="screen">
    <button id="homeBtn" class="pill">🏠 Home</button>
    <h2>Create Task</h2>

    <div class="card form-section">
      <div class="form-title">1️⃣ Select Task Type</div>
      <select id="taskType" class="in">
        <option value="">Select Type</option>
        <option value="Inspection">Inspection</option>
        <option value="Spot Spray">Spot Spray</option>
        <option value="Road Spray">Road Spray</option>
      </select>
    </div>

    <div class="card form-section">
      <div class="form-title">2️⃣ Get Location</div>
      <button id="locateBtn" class="pill">📍 Get Location</button>
      <div class="mt small">Road: <b id="locRoad">Unknown</b></div>
    </div>

    <div class="card form-section">
      <div class="form-title">3️⃣ Auto Job Name</div>
      <div class="grid two tight">
        <input id="jobName" class="in" readonly placeholder="RoadDDMMYYYY_I/SS/RS" />
        <button id="autoNameBtn" class="pill">🪪 Auto Generate</button>
      </div>
      <div class="grid two mt-2">
        <input id="councilNum" class="in" placeholder="Council Job Number (optional)" />
        <select id="statusSelect" class="in">
          <option value="Incomplete" selected>Incomplete</option>
          <option value="Complete">Complete</option>
          <option value="Draft">Draft</option>
        </select>
      </div>
      <div class="grid two mt-2">
        <input id="jobDate" type="date" class="in" />
        <select id="reminderWeeks" class="in">
          <option value="0">Reminder: None</option>
        </select>
      </div>
    </div>

    <div class="card form-section">
      <div class="form-title">4️⃣ Date & Weather</div>
      <div class="row gap">
        <button id="autoWeatherBtn" class="pill">🌦️ Auto Fill Weather</button>
        <span class="small">Updated: <span id="wxUpdated">—</span></span>
      </div>
      <div class="grid two mt">
        <input id="temp" class="in" placeholder="Temp (°C)" />
        <input id="humidity" class="in" placeholder="Humidity (%)" />
        <input id="wind" class="in" placeholder="Wind Speed (km/h)" />
        <input id="windDir" class="in" placeholder="Wind Direction" />
      </div>
    </div>

    <div class="card form-section">
      <div class="form-title">5️⃣ Select Weed</div>
      <select id="weedSelect" class="in"></select>
    </div>

    <div class="card form-section">
      <div class="form-title">6️⃣ Select Batch</div>
      <select id="batchSelect" class="in"></select>
    </div>

    <div class="card form-section">
      <div class="form-title">7️⃣ Times</div>
      <div class="grid two">
        <input id="startTime" type="time" class="in" />
        <input id="endTime" type="time" class="in" />
      </div>
    </div>

    <div class="card form-section">
      <div class="form-title">8️⃣ Notes</div>
      <textarea id="notes" class="in" rows="3" placeholder="Notes"></textarea>
    </div>

    <div id="roadTrackBlock" class="card form-section" style="display:none">
      <div class="form-title">🛣️ Roadside Tracking</div>
      <div class="row gap">
        <button id="trackStart" class="pill emph">▶️ Start</button>
        <button id="trackStop" class="pill warn">⏹ Stop</button>
      </div>
    </div>

    <div class="card form-section sticky-action">
      <div class="row end gap">
        <button id="saveDraft" class="pill">🗂 Save Draft</button>
        <button id="saveTask" class="pill emph">💾 Save Task</button>
      </div>
    </div>
  </div>

  <!-- Records -->
  <div id="records" class="screen">
    <button class="pill" id="homeBtn2">🏠 Home</button>
    <h2>Records</h2>
    <div class="search-block">
      <input id="recSearch" class="in" placeholder="Search: job / road / weed / batch / council #" />
      <div class="grid two">
        <input id="recFrom" type="date" class="in" />
        <input id="recTo" type="date" class="in" />
      </div>
      <div class="row wrap gap">
        <label class="chip"><input type="checkbox" id="fInspection"> Inspection</label>
        <label class="chip"><input type="checkbox" id="fSpot"> Spot Spray</label>
        <label class="chip"><input type="checkbox" id="fRoad"> Road Spray</label>
        <label class="chip"><input type="checkbox" id="fComplete"> Complete</label>
        <label class="chip"><input type="checkbox" id="fIncomplete"> Incomplete</label>
        <label class="chip"><input type="checkbox" id="fDraft"> Draft</label>
      </div>
    </div>
    <div id="recordsList" class="list"></div>
  </div>

  <!-- Batches -->
  <div id="batches" class="screen">
    <button class="pill" id="homeBtn3">🏠 Home</button>
    <h2>Batches</h2>
    <div class="search-block">
      <input id="batSearch" class="in" placeholder="Search: batch ID / chemical / job / road" />
      <div class="grid two">
        <input id="batFrom" type="date" class="in" />
        <input id="batTo" type="date" class="in" />
      </div>
    </div>
    <div id="batchList" class="list"></div>
  </div>

  <!-- Mapping -->
  <div id="mapping" class="screen">
    <button class="pill" id="homeBtn4">🏠 Home</button>
    <h2>Mapping</h2>
    <div id="mapWrap" class="map-wrap">
      <div id="map" class="map"></div>
      <button id="locateTop" class="locate-fab pill">Locate Me</button>
    </div>
  </div>

  <!-- Settings -->
  <div id="settings" class="screen">
    <button class="pill" id="homeBtn5">🏠 Home</button>
    <h2>Settings</h2>
    <div class="row gap">
      <button id="exportDataBtn" class="pill">📤 Export Data</button>
      <button id="clearDataBtn" class="pill warn">🧹 Clear All Data</button>
    </div>
  </div>

  <!-- Spinner overlay -->
  <div id="spinner" class="spinner-overlay">
    <div class="spinner"></div>
    <div id="spinnerMsg" class="spinner-msg">Working…</div>
  </div>

  <!-- Fix Pack placeholder -->
  <script src="fixpack.js"></script>
</body>
</html>
